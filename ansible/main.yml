---
- name: Configure project authorization
  hosts: all
  roles:
    - role: auth
- name: Setup Jenkins and registry push credentials
  hosts: dev
  roles:
    - role: jenkins
    - role: pusher
- name: Setup registry tokens
  hosts:
    - stage
    - prod
  roles:
    - role: puller
- name: Open up registry to anon pulls
  hosts: registry
  tasks:
    - name: Open registry to anonymous pulls
      command: "{{ oc }} policy add-role-to-group registry-viewer system:unauthenticated"
